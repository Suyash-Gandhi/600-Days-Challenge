

# OSI Model & How Packets Traverse Networks (Detailed Explanation)

## 1. Introduction to the OSI Model

The OSI (Open Systems Interconnection) model is a conceptual framework that standardizes how data moves across a network.
It divides communication into 7 layers, each with its own responsibilities.
Understanding OSI helps you analyze network behavior, troubleshoot issues, and understand how attackers exploit different layers.

---

# 2. Seven Layers of the OSI Model (With Functions)

---

## Layer 7 – Application Layer

 Closest to the user.
 Provides services like web browsing, email, file transfer.
 Protocols: HTTP, HTTPS, FTP, DNS, SMTP.
 Security relevance: phishing, malware delivery, DNS spoofing start here.

---

## Layer 6 – Presentation Layer

 Translates data formats (JSON, XML, JPEG, MP4).
 Handles:

   Encryption/decryption (SSL/TLS handshake).
   Compression.
 Security relevance: encryption protects confidentiality.

---

## Layer 5 – Session Layer

 Establishes, maintains, and terminates communication sessions.
 Responsible for:

   Authentication.
   Session checkpoints.
 Protocols: NetBIOS, RPC.
 Attack example: Session hijacking.

---

## Layer 4 – Transport Layer

 Provides end-to-end communication.
 Two main protocols:

   TCP → Reliable (3-way handshake)
   UDP → Unreliable but faster (gaming, streaming)
 Handles port numbers.
 Attack relevance:

   SYN Flood (DDoS)
   Port scanning (Nmap)

---

## Layer 3 – Network Layer

 Handles routing packets across networks.
 Uses IP addresses.
 Protocols: IPv4, IPv6, ICMP, ARP (layer 2.5)
 Devices: Routers.
 Attack relevance: IP spoofing, DDoS, traceroute enumeration.

---

## Layer 2 – Data Link Layer

 Handles communication on the local network.
 Converts packets → frames.
 Uses MAC addresses.
 Divided into:

   LLC (logic)
   MAC (hardware addressing)
 Devices: Switches.
 Attacks: MAC spoofing, ARP poisoning, VLAN hopping.

---

## Layer 1 – Physical Layer

 Transmits raw bits (0s and 1s).
 Physical mediums:

   Copper cables
   Fiber optics
   Radio waves (Wi-Fi)
 Attacks: Wire tapping, RF jamming.

---

# 3. How a Packet Traverses a Network (Step-by-Step)

This is important for understanding how communication actually happens.

We’ll follow the journey of a packet from your laptop to a web server.

---

## Step 1 — Application Generates Data (Layer 7)

Example: You type google.com into Chrome.

The browser creates an HTTP GET request.

---

## Step 2 — Data is Encoded (Layer 6)

The browser converts request into the right formats:

 Encodes text
 Applies encryption (HTTPS → TLS encryption)

---

## Step 3 — Session Setup (Layer 5)

A session is created:

 TCP 3-way handshake begins
 SSL/TLS handshake (if HTTPS)

---

## Step 4 — Transport Layer Adds Ports (Layer 4)

Transport layer adds:

 Source port (random, e.g., 50001)
 Destination port (80 for HTTP, 443 for HTTPS)

This becomes a segment (TCP) or datagram (UDP).

---

## Step 5 — Network Layer Adds IP Addresses (Layer 3)

Adds:

 Source IP: your device IP (like 192.168.0.20)
 Destination IP: google server IP (like 142.250.195.110)

Now it is a packet.

Routers use this layer to forward packets across the internet.

---

## Step 6 — Data Link Layer Adds MAC Addresses (Layer 2)

Your device sends the packet to your default gateway (router).

It needs the router’s MAC address (ARP request/response).

Frame contains:

 Source MAC: Your PC MAC
 Destination MAC: Router MAC

Now it becomes a frame.

---

## Step 7 — Physical Layer Converts Bits and Sends (Layer 1)

The frame is converted into:

 Electric signals (Ethernet)
 Radio waves (Wi-Fi)

It travels to the router.

---

# 4. What Happens Next in the Network?

After reaching your router:

---

## Router Removes Layer 2 Info

Router strips:

 Your MAC address
 Its own MAC address

---

## Router Reads Layer 3 (IP Address)

Router checks:

 “Where should this packet go next?”

Uses routing tables.

---

## Router Rewraps Frame with New MAC Address

Because MAC addresses only work inside a local network, every time the packet moves to another network:

 MAC changes
 IP remains the same

This process repeats hop-by-hop across the internet.

---

## Finally, the Packet Reaches the Server

At the destination:

1. MAC addresses verified
2. IP verified
3. PORT verified (server checks port 443)
4. SSL/TLS decrypted
5. HTTP request read by server

The server then sends the response back following the same OSI path but in reverse.

---

# 5. Encapsulation vs Decapsulation

### Encapsulation

When your device sends data:

 Each layer adds its own header → PDU grows

### Decapsulation

When data arrives at the destination:

 Each layer removes its header → PDU shrinks

---

# 6. Why OSI Matters for Cybersecurity

Attackers exploit weaknesses in layers:

| OSI Layer | Example Attack             |
| --------- | -------------------------- |
| 7         | Phishing, API abuse        |
| 6         | SSL stripping              |
| 5         | Session hijacking          |
| 4         | SYN flood                  |
| 3         | IP spoofing, DDoS          |
| 2         | ARP spoofing, MAC flooding |
| 1         | Wi-Fi jamming              |

Understanding OSI helps identify where an attack is happening.

---

# 7. Simple Real-World Example (Complete Flow)

### You → Wi-Fi → Router → ISP → Internet → Server

1. Browser → HTTP request (L7)
2. TLS encrypts (L6)
3. TCP handshake (L5/L4)
4. IP address added (L3)
5. MAC address added (L2)
6. Wi-Fi signals sent (L1)
7. Router forwards packet using routing table (L3)
8. MAC changed at each hop (L2)
9. Packet reaches server (L7)
10. Server decapsulates, reads request, sends response back

---

# 8. Summary (Exam-Friendly + Interview-Friendly)

### OSI Model = 7 Layers

Each has specific roles and vulnerabilities.

### Packet Traversal:

From top (Application) to bottom (Physical) → Encapsulation
Across network routers → Routing
Bottom to top at receiver → Decapsulation

### Key Concept:

 Ports = Process to process
 IP = Device to device
 MAC = Local network hop-to-hop

---

