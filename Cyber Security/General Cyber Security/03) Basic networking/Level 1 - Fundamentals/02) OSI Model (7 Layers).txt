
# The OSI Model (7 Layers) â€” Complete Explanation for Cybersecurity & Attackers

The OSI (Open Systems Interconnection) Model is a conceptual framework that explains how data moves from one device to another across networks. It breaks communication into 7 layers, each with its own functions, protocols, vulnerabilities, and attacker opportunities.

For ethical hackers and cybersecurity learners, OSI is not just theory â€” it helps you understand where attacks happen, how packets travel, where defenses exist, and how to break or bypass them.

---

# ðŸ§± The 7 Layers of the OSI Model (Top â†’ Bottom)

| No. | Layer        | Keyword        | Example                 |
| --- | ------------ | -------------- | ----------------------- |
| 7   | Application  | User Interface | HTTP, DNS, SMTP         |
| 6   | Presentation | Data Format    | Encryption, Compression |
| 5   | Session      | Connections    | TLS handshake, NetBIOS  |
| 4   | Transport    | Data Delivery  | TCP, UDP                |
| 3   | Network      | Routing        | IP, ICMP                |
| 2   | Data Link    | Frames         | MAC, ARP, Switches      |
| 1   | Physical     | Hardware       | Cables, Wi-Fi, signals  |

---

# Layer 1: Physical Layer

### Purpose

The Physical Layer deals with raw bit transmission â€” converting 0s and 1s into electrical, optical, or radio signals.

### Examples

 Cables (Ethernet, Coaxial, Fiber)
 Wi-Fi radio waves
 Switch ports
 Hubs
 Voltage levels
 Hardware NIC

### Attacker Perspective

Even the lowest layer has attack vectors:

#### 1. Wi-Fi Signal Attacks

 Jamming / signal interference
 Deauthentication attacks
 Rogue access points

#### 2. Physical Tapping

 Fiber tapping
 Man-in-the-Middle via physical cable insert
 Hardware keyloggers

#### 3. Hardware-based Attacks

 Evil Maid attacks
 Tampering with network ports

Why It's Important:
All higher layers depend on this â€” attackers exploit weak physical security to bypass everything else.

---

# Layer 2: Data Link Layer

### Purpose

Responsible for:

 Framing (packets â†’ frames)
 Error detection
 MAC addressing
 Local network communication (LAN)

Divided into:

1. LLC (Logical Link Control)
2. MAC (Media Access Control)

### Examples

 MAC addresses (e.g., 00:1A:2B:3C:4D:5E)
 Ethernet frames
 ARP (Address Resolution Protocol)
 VLANs
 Switches & bridges

---

### Attacker Perspective

Layer 2 is where local-network attacks happen.

### 1. ARP Spoofing / Poisoning

Attackers send fake ARP replies:

 Associate attacker's MAC with gateway IP
 Result: MITM, sniffing, session hijacking

Tools: ettercap, arpspoof, Bettercap

### 2. MAC Flooding

Flood the switch with fake MAC addresses â†’ switch fails â†’ behaves like hub â†’ attacker can sniff traffic.

Tool: macof

### 3. VLAN Hopping

Improper VLAN configuration lets attacker jump between networks.

### 4. Rogue DHCP Server

Attacker gives victims:

 Fake gateway
 Fake DNS
 Leads to MITM

Layer 2 = hacker playground inside local networks.

---

# Layer 3: Network Layer

### Purpose

Controls routing, IP addressing, and packet forwarding.

### Protocols

 IP (IPv4/IPv6)
 ICMP (ping)
 IPSec
 Routing protocols (OSPF, BGP, RIP)

### Devices

 Routers
 Layer-3 switches
 Firewalls

---

### Attacker Perspective

Attacks here generally target IP and routing systems.

### 1. IP Spoofing

Modify source IP:

 Bypass filters
 Perform reflection/amplification attacks

### 2. ICMP Tunneling

Covert channels using ping for data exfiltration.
Tool: Ptunnel

### 3. Ping Sweep Reconnaissance

Nmap / fping to discover active hosts.

### 4. Route Manipulation / Hijacking

 BGP hijacking
 Blackhole routing
 Redirect traffic for MITM

### 5. Fragmentation Attacks

Split malicious traffic into fragments that bypass firewalls.

Network layer is crucial for scanners, pivoting, reconnaissance.

---

# Layer 4: Transport Layer

### Purpose

Manages end-to-end communication:

 Reliability
 Error recovery
 Port numbers
 Flow control

### Main Protocols

 TCP
 UDP
 SCTP

### Important Concepts

 TCP 3-way handshake
 Port numbers

   80 (HTTP)
   443 (HTTPS)
   22 (SSH)
 Segments

---

### Attacker Perspective

Layer 4 is where port scanning and session attacks live.

### 1. TCP SYN Scanning

Nmapâ€™s most popular scan:

 Send SYN â†’ analyze response
 Stealthy and fast

### 2. TCP RST Injection

Inject reset packets into established connections.

Used for:

 Session hijacking
 Breaking secure communications

### 3. UDP Scanning

Finding services like:

 DNS (53)
 SNMP (161)
 NTP (123)

### 4. SYN Flood DoS

Overwhelm server with half-open TCP connections.

### 5. TCP Session Hijacking

Predict sequence numbers and take over communication.

Transport layer is the battleground for attackers during recon & exploitation.

---

# Layer 5: Session Layer

### Purpose

Manages sessions between two end-points:

 Start a session
 Maintain a session
 Terminate a session

### Examples

 TLS handshake
 RPC (Remote Procedure Call)
 NetBIOS
 SMB session establishment

---

### Attacker Perspective

### 1. Session Hijacking

Steal session credentials like:

 Cookies
 Authentication tokens
 SMB session IDs

### 2. Man-in-the-Middle in TLS Negotiation

Downgrade attacks:

 Force TLS 1.0 or weaker cipher suites
 Prevent use of strong encryption

### 3. Brute-forcing login sessions

 SSH session attempts
 SMB login attempts

Session layer attacks are all about breaking the trust between systems.

---

# Layer 6: Presentation Layer

### Purpose

Handles data formatting:

 Encryption
 Compression
 Encoding

Acts as the "translator" layer.

### Examples

 SSL/TLS encryption
 Base64 encoding
 JPEG, PNG, MP3, JSON
 ASCII, UTF-8

---

### Attacker Perspective

### 1. Encryption Downgrade Attacks

Force system to:

 Use weak ciphers
 Disable secure algorithms
 Revert to DES/RC4

### 2. SSL Stripping

Convert HTTPS â†’ HTTP to sniff traffic.

### 3. Data Encoding Misuse

Base64 Trickery:

 Hide payloads
 Evade filters
 Obfuscate malware

### 4. Serialization Attacks

Exploit unsafe data serialization:

 Java serialization attacks
 PHP unserialize(RCE)

Presentation layer matters because attackers exploit how data is represented.

---

# Layer 7: Application Layer

### Purpose

Topmost layer â€” interacts directly with user/software.

This is where most vulnerabilities exist.

### Common Protocols

 HTTP/HTTPS
 FTP
 DNS
 SMTP
 SSH
 Telnet
 SNMP

### Examples of Application Layer Communication

 Browsers
 Email clients
 APIs
 Web apps

---

### Attacker Perspective

This layer has the biggest attack surface.

### 1. Web Application Attacks

 SQL Injection
 XSS
 CSRF
 File upload RCE
 SSRF
 Open redirects

### 2. API Attacks

 Broken Access Control
 Token replay
 JWT manipulation

### 3. DNS Attacks

 Spoofing
 Cache poisoning
 Subdomain takeover

### 4. Email Attacks

 Phishing
 SMTP spoofing
 Open mail relays

### 5. Authentication Attacks

 Password brute force
 Credential stuffing
 Session fixation

### 6. Command Injection

 Remote Code Execution (RCE)
 Shell Injection
 Template Injection

Layer 7 is where 90% of hacking happens.

---

# ðŸ§ª How Data Travels Through All 7 Layers (Attacker View)

Letâ€™s follow an HTTP request:

## 1. Application Layer (7)

User types: `http://example.com/login`

Browser creates HTTP request.

## 2. Presentation Layer (6)

Data may be:

 Compressed
 Encrypted (HTTPS)
 Encoded

## 3. Session Layer (5)

Creates/maintains session with server:

 TLS handshake
 Cookies
 Session tokens

## 4. Transport Layer (4)

TCP breaks request into segments â†’
Adds source and destination ports.

## 5. Network Layer (3)

IP addresses added:

 Source IP
 Destination IP

Routers forward packet.

## 6. Data Link Layer (2)

Frame created:

 MAC source
 MAC destination

Switch forwards frame.

## 7. Physical Layer (1)

Electrical/radio signals transmit the bits over cable or Wi-Fi.

---

# ðŸ›¡ Attacks Mapped to OSI Layers

| Layer | Example Attacks                           |
| ----- | ----------------------------------------- |
| 7     | SQLi, XSS, CSRF, SSRF, RCE                |
| 6     | SSL stripping, encryption downgrade       |
| 5     | Session hijacking, SMB relay              |
| 4     | SYN flood, TCP hijacking, UDP flood       |
| 3     | IP spoofing, ICMP tunnel, BGP hijack      |
| 2     | ARP poisoning, MAC flooding, VLAN hopping |
| 1     | Wi-Fi jamming, cable tapping              |

This mapping is extremely useful for penetration testers.

---

# ðŸ›  Tools Used Per Layer (Attacker Toolkit)

| Layer | Tools                                |
| ----- | ------------------------------------ |
| 7     | Burp Suite, OWASP ZAP, SQLmap, ffuf  |
| 6     | sslsplit, openssl, bettercap         |
| 5     | Responder, CrackMapExec              |
| 4     | Nmap, hping3, Scapy                  |
| 3     | traceroute, arping, ptunnel          |
| 2     | ettercap, arpspoof, netcut, yersinia |
| 1     | aircrack-ng, Wireshark monitor mode  |

---

# Why Every Ethical Hacker Must Master OSI

 It explains exactly where an attack occurs.
 Helps in packet analysis (Wireshark).
 Helps design exploitation chains.
 Helps in defense evasion.
 Helps understand firewalls, IDS/IPS, proxies.
 Essential for network scanning and reconnaissance.

Without OSI understanding, network hacking feels random.
With OSI understanding, everything becomes logical and predictable.

---


